angular.module("angular.tourist",[]),angular.module("angular.tourist").directive("tourStep",["tourist",function(t){return{restrict:"EAC",link:function(e,i,s){return t.registerStep(s.tourStep,i)}}}]),angular.module("angular.tourist").directive("tourTemplate",["tourist","$window","$templateCache","$interpolate",function(t,e,i,s){return i.put("angular/tourist.html",'<div ng-class="styles" ng-if="$show" ng-class="class"> </div>'),{restrict:"EA",templateUrl:function(t,e){return e.src||"angular/tourist.html"},scope:{templateName:"@tourTemplate","class":"@activeClass"},controller:["$scope","tourist",function(t){var i;return i=function(t){var i,s,n;if(null!=t&&(s=t.ownerDocument,n=s.documentElement,i="function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():void 0,null!=i))return{top:i.top+(e.pageYOffset||n.scrollTop)-(n.clientTop||0),left:i.left+(e.pageXOffset||n.scrollLeft)-(n.clientLeft||0),width:t.offsetWidth,height:t.offsetHeight}},this.show=function(e,n){return t.$show=!0,t.$pos=angular.extend(i(e[0]),{position:"absolute"}),t.$data=n.data,t.$content=s(n.content)(t)},this.hide=function(){return function(){return t.$show=!1}}(this)}],link:function(e,i,s,n){return t.registerTemplate(e.templateName,n),e.tourist=t}}}]);var Tour,__bind=function(t,e){return function(){return t.apply(e,arguments)}},__indexOf=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};Tour=function(){function t(t){this.registerTemplate=__bind(this.registerTemplate,this),this.registerStep=__bind(this.registerStep,this),this.stepScope=__bind(this.stepScope,this),this.getStep=__bind(this.getStep,this),this.getElementStepData=__bind(this.getElementStepData,this),this.setSteps=__bind(this.setSteps,this),this.getElement=__bind(this.getElement,this),this.getTemplate=__bind(this.getTemplate,this),this.leave=__bind(this.leave,this),this.enter=__bind(this.enter,this),this.showStep=__bind(this.showStep,this),this.setActiveStep=__bind(this.setActiveStep,this),this.emit=__bind(this.emit,this),this.on=__bind(this.on,this),this.activate=__bind(this.activate,this),this.previous=__bind(this.previous,this),this.isLastStep=__bind(this.isLastStep,this),this.hasPrevious=__bind(this.hasPrevious,this),this.hasNext=__bind(this.hasNext,this),this.next=__bind(this.next,this),this.end=__bind(this.end,this),this.start=__bind(this.start,this),this.reset=__bind(this.reset,this),this.options=t,this.elements={},this.templates={},this.reset(),null!=t.enter&&this.on("enter",t.enter),null!=t.leave&&this.on("leave",t.leave),this.on("enter",this.enter),this.on("leave",this.leave),this.options.autostart&&this.start()}return t.PROPS=["content","values"],t.EVT_PROPS=["enter","leave","completed","started"],t.prototype.reset=function(){return this.index=!1,this.activeStep=null,this.lastStep=null},t.prototype.start=function(t){return null==t&&(t=0),this.setSteps(this.options.steps),null==this.activeStep?(this.setActiveStep(t),this.activate(),this.emit("started")):void 0},t.prototype.end=function(){return null!=this.activeStep?(this.emit("leave",this.activeStep),this.getTemplate().hide(),this.emit("complete"),this.reset()):void 0},t.prototype.next=function(){return this.setActiveStep(this.index+1)?this.activate():this.end()},t.prototype.hasNext=function(){return this.index<this.steps.length-1},t.prototype.hasPrevious=function(){return this.index>0},t.prototype.isLastStep=function(){return this.index===this.steps.length-1},t.prototype.previous=function(){return this.setActiveStep(this.index-1)?this.activate():void 0},t.prototype.activate=function(){return null!=this.lastStep&&this.emit("leave",this.lastStep),this.emit("enter",this.activeStep),this.showStep()},t.prototype.on=function(e,i){return t.$rootScope.$on("$$tour-"+e,i)},t.prototype.emit=function(e,i){var s;return null==i&&(i=null),i&&(s=i[e])&&s.apply(this,[this.stepScope(i)]),t.$rootScope.$emit("$$tour-"+e,this,i)},t.prototype.setActiveStep=function(t){return t>=this.steps.length?this.index=null:t>=0?(this.index!==!1&&(this.lastStep=this.getStep(this.index)),this.index=t,this.activeStep=this.getStep(t),!0):void 0},t.prototype.showStep=function(){return this.getTemplate().show(this.getElement(),this.activeStep)},t.prototype.enter=function(){var t;return t=this.getElement(),null!=this.activeStep.activeClass?t.addClass(this.activeStep.activeClass):void 0},t.prototype.leave=function(){var t;return t=this.getElement(),null!=this.activeStep.activeClass?t.removeClass(this.activeStep.activeClass):void 0},t.prototype.getTemplate=function(){return this.templates[this.activeStep.template||"default"]},t.prototype.getElement=function(t){return null==t&&(t=this.activeStep),this.elements[t["for"]]},t.prototype.setSteps=function(t){var e,i,s,n,r;for(this.steps=[],e=this.options.stepDefault||{},n=0,r=t.length;r>n;n++)s=t[n],i=angular.extend({},e||{},s,this.getElementStepData(s)),null!=e.values&&(i.values=angular.extend({},e.values,s.values)),this.steps.push(i)},t.prototype.getElementStepData=function(e){var i,s,n,r;return s=this.getElement(e),n=s.scope(),r={},i=t.$parse,angular.forEach(t.PROPS.concat(t.EVT_PROPS),function(){return function(e){var o;if(o=s.attr("tour-"+e))return __indexOf.call(t.EVT_PROPS,e)>=0?o=i(o):"values"===e&&(o=n.$eval(o)),r[e]=o}}(this)),r},t.prototype.getStep=function(){return this.steps[this.index]},t.prototype.stepScope=function(t){return angular.element(this.elements[t["for"]]).scope()},t.prototype.registerStep=function(t,e){return this.elements[t]=e},t.prototype.registerTemplate=function(t,e){return this.templates[t||"default"]=e},t}(),angular.module("angular.tourist").provider("tourist",function(){var t;t=null,this.define=function(){return function(e){t=e}}(this),this.$get=["$injector","$rootScope","$parse",function(e,i,s){return Tour.$rootScope=i,Tour.$injector=e,Tour.$parse=s,new Tour(t)}]});